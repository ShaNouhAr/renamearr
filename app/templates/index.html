<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Renamearr</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <div class="logo">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                        <polyline points="7.5 4.21 12 6.81 16.5 4.21"/>
                        <polyline points="7.5 19.79 7.5 14.6 3 12"/>
                        <polyline points="21 12 16.5 14.6 16.5 19.79"/>
                        <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
                        <line x1="12" y1="22.08" x2="12" y2="12"/>
                    </svg>
                    <span>Renamearr</span>
                </div>
                <nav class="nav-tabs">
                    <button class="nav-tab active" data-tab="files" onclick="switchTab('files')">Fichiers</button>
                    <button class="nav-tab" data-tab="config" onclick="switchTab('config')">Configuration</button>
                    <button class="nav-tab" data-tab="users" onclick="switchTab('users')">Utilisateurs</button>
                </nav>
            </div>
            <div class="header-right">
                <button class="btn btn-primary" onclick="scanFiles()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/>
                        <path d="M21 3v5h-5"/>
                    </svg>
                    Scanner
                </button>
                <div class="user-menu">
                    <button class="btn btn-ghost user-btn" onclick="toggleUserMenu()">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                            <circle cx="12" cy="7" r="4"/>
                        </svg>
                        <span id="current-username">Admin</span>
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"/>
                        </svg>
                    </button>
                    <div class="user-dropdown" id="user-dropdown">
                        <button onclick="openChangePassword()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                            </svg>
                            Changer mot de passe
                        </button>
                        <button onclick="logout()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                                <polyline points="16 17 21 12 16 7"/>
                                <line x1="21" y1="12" x2="9" y2="12"/>
                            </svg>
                            D√©connexion
                        </button>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Password Warning Banner -->
        <div class="warning-banner" id="password-warning" style="display: none;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                <line x1="12" y1="9" x2="12" y2="13"/>
                <line x1="12" y1="17" x2="12.01" y2="17"/>
            </svg>
            <span>‚ö†Ô∏è <strong>Attention :</strong> Vous utilisez le mot de passe par d√©faut (root/root). <a href="#" onclick="openChangePassword(); return false;">Changez-le maintenant</a> pour s√©curiser votre installation.</span>
            <button class="warning-close" onclick="hidePasswordWarning()">√ó</button>
        </div>

        <!-- Stats -->
        <div class="stats-bar">
            <div class="stat-item">
                <span class="stat-value" id="stat-total">0</span>
                <span class="stat-label">Total</span>
                <div class="stat-details">
                    <span class="stat-detail" title="Films">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"/><line x1="7" y1="2" x2="7" y2="22"/><line x1="17" y1="2" x2="17" y2="22"/><line x1="2" y1="12" x2="22" y2="12"/><line x1="2" y1="7" x2="7" y2="7"/><line x1="2" y1="17" x2="7" y2="17"/><line x1="17" y1="17" x2="22" y2="17"/><line x1="17" y1="7" x2="22" y2="7"/></svg>
                        <span id="stat-movies-total">0</span>
                    </span>
                    <span class="stat-detail" title="√âpisodes">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="15" rx="2" ry="2"/><polyline points="17 2 12 7 7 2"/></svg>
                        <span id="stat-tv-total">0</span>
                    </span>
                </div>
            </div>
            <div class="stat-item stat-pending">
                <span class="stat-value" id="stat-pending">0</span>
                <span class="stat-label">En attente</span>
                <div class="stat-details">
                    <span class="stat-detail" title="Films">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"/><line x1="7" y1="2" x2="7" y2="22"/><line x1="17" y1="2" x2="17" y2="22"/><line x1="2" y1="12" x2="22" y2="12"/><line x1="2" y1="7" x2="7" y2="7"/><line x1="2" y1="17" x2="7" y2="17"/><line x1="17" y1="17" x2="22" y2="17"/><line x1="17" y1="7" x2="22" y2="7"/></svg>
                        <span id="stat-pending-movies">0</span>
                    </span>
                    <span class="stat-detail" title="√âpisodes">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="15" rx="2" ry="2"/><polyline points="17 2 12 7 7 2"/></svg>
                        <span id="stat-pending-tv">0</span>
                    </span>
                </div>
            </div>
            <div class="stat-item stat-linked">
                <span class="stat-value" id="stat-linked">0</span>
                <span class="stat-label">Li√©s</span>
                <div class="stat-details">
                    <span class="stat-detail" title="Films">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"/><line x1="7" y1="2" x2="7" y2="22"/><line x1="17" y1="2" x2="17" y2="22"/><line x1="2" y1="12" x2="22" y2="12"/><line x1="2" y1="7" x2="7" y2="7"/><line x1="2" y1="17" x2="7" y2="17"/><line x1="17" y1="17" x2="22" y2="17"/><line x1="17" y1="7" x2="22" y2="7"/></svg>
                        <span id="stat-linked-movies">0</span>
                    </span>
                    <span class="stat-detail" title="√âpisodes">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="15" rx="2" ry="2"/><polyline points="17 2 12 7 7 2"/></svg>
                        <span id="stat-linked-tv">0</span>
                    </span>
                </div>
            </div>
            <div class="stat-item stat-manual">
                <span class="stat-value" id="stat-manual">0</span>
                <span class="stat-label">Manuel</span>
                <div class="stat-details">
                    <span class="stat-detail" title="Films">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"/><line x1="7" y1="2" x2="7" y2="22"/><line x1="17" y1="2" x2="17" y2="22"/><line x1="2" y1="12" x2="22" y2="12"/><line x1="2" y1="7" x2="7" y2="7"/><line x1="2" y1="17" x2="7" y2="17"/><line x1="17" y1="17" x2="22" y2="17"/><line x1="17" y1="7" x2="22" y2="7"/></svg>
                        <span id="stat-manual-movies">0</span>
                    </span>
                    <span class="stat-detail" title="√âpisodes">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="15" rx="2" ry="2"/><polyline points="17 2 12 7 7 2"/></svg>
                        <span id="stat-manual-tv">0</span>
                    </span>
                </div>
            </div>
            <div class="stat-item stat-failed">
                <span class="stat-value" id="stat-failed">0</span>
                <span class="stat-label">√âchecs</span>
                <div class="stat-details">
                    <span class="stat-detail" title="Films">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"/><line x1="7" y1="2" x2="7" y2="22"/><line x1="17" y1="2" x2="17" y2="22"/><line x1="2" y1="12" x2="22" y2="12"/><line x1="2" y1="7" x2="7" y2="7"/><line x1="2" y1="17" x2="7" y2="17"/><line x1="17" y1="17" x2="22" y2="17"/><line x1="17" y1="7" x2="22" y2="7"/></svg>
                        <span id="stat-failed-movies">0</span>
                    </span>
                    <span class="stat-detail" title="√âpisodes">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="15" rx="2" ry="2"/><polyline points="17 2 12 7 7 2"/></svg>
                        <span id="stat-failed-tv">0</span>
                    </span>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main">
            <!-- Tab: Files -->
            <div class="tab-content active" id="tab-files">
                <!-- Filters -->
                <div class="filters">
                    <div class="filter-group">
                        <select id="filter-status" onchange="loadFiles()">
                            <option value="">Tous les statuts</option>
                            <option value="pending">En attente</option>
                            <option value="matched">Correspondance</option>
                            <option value="linked">Li√©</option>
                            <option value="manual">Manuel</option>
                            <option value="failed">√âchec</option>
                            <option value="ignored">Ignor√©</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <select id="filter-type" onchange="loadFiles()">
                            <option value="">Tous les types</option>
                            <option value="movie">Films</option>
                            <option value="tv">S√©ries</option>
                            <option value="unknown">Inconnu</option>
                        </select>
                    </div>
                    <div class="filter-group search-group">
                        <input type="text" id="search-input" placeholder="Rechercher..." onkeyup="debounceSearch()">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="m21 21-4.35-4.35"/>
                        </svg>
                    </div>
                </div>

                <!-- Files List -->
                <div class="files-container">
                    <div class="files-list" id="files-list">
                        <!-- Files loaded via JS -->
                    </div>
                </div>
            </div>

            <!-- Tab: Configuration -->
            <div class="tab-content" id="tab-config">
                <div class="config-container">
                    <h2>Configuration</h2>
                    
                    <div class="config-section">
                        <h3>üìÅ Dossiers sources (torrents rclone)</h3>
                        
                        <div class="config-field">
                            <label>Mode de source</label>
                            <div class="mode-selector">
                                <button class="mode-btn active" data-mode="unified" onclick="setSourceMode('unified')">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                                    </svg>
                                    <span>1 dossier unique</span>
                                    <small>Films et s√©ries dans le m√™me dossier</small>
                                </button>
                                <button class="mode-btn" data-mode="separate" onclick="setSourceMode('separate')">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                                        <path d="M12 11v8"/>
                                    </svg>
                                    <span>2 dossiers s√©par√©s</span>
                                    <small>Un dossier films + un dossier s√©ries</small>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Mode unifi√© -->
                        <div id="source-unified" class="source-config">
                            <div class="config-field">
                                <label>Dossier source (films + s√©ries)</label>
                                <div class="path-input">
                                    <input type="text" id="config-source-path" placeholder="/mnt/alldebrid/torrents">
                                    <button class="btn btn-secondary" onclick="openBrowser('source_path')">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                                        </svg>
                                        Parcourir
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Mode s√©par√© -->
                        <div id="source-separate" class="source-config" style="display: none;">
                            <div class="config-field">
                                <label>üé¨ Dossier source Films</label>
                                <div class="path-input">
                                    <input type="text" id="config-source-movies-path" placeholder="/mnt/alldebrid/movies">
                                    <button class="btn btn-secondary" onclick="openBrowser('source_movies_path')">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                                        </svg>
                                        Parcourir
                                    </button>
                                </div>
                            </div>
                            <div class="config-field">
                                <label>üì∫ Dossier source S√©ries</label>
                                <div class="path-input">
                                    <input type="text" id="config-source-tv-path" placeholder="/mnt/alldebrid/tv">
                                    <button class="btn btn-secondary" onclick="openBrowser('source_tv_path')">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                                        </svg>
                                        Parcourir
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="config-section">
                        <h3>üìÇ Dossiers destination (pour Plex/Sonarr/Radarr)</h3>
                        
                        <div class="config-field">
                            <label>üé¨ Dossier destination Films</label>
                            <div class="path-input">
                                <input type="text" id="config-movies-path" placeholder="/mnt/media/movies">
                                <button class="btn btn-secondary" onclick="openBrowser('movies_path')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                                    </svg>
                                    Parcourir
                                </button>
                            </div>
                        </div>
                        
                        <div class="config-field">
                            <label>üì∫ Dossier destination S√©ries TV</label>
                            <div class="path-input">
                                <input type="text" id="config-tv-path" placeholder="/mnt/media/tv">
                                <button class="btn btn-secondary" onclick="openBrowser('tv_path')">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
                                    </svg>
                                    Parcourir
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="config-section">
                        <h3>üé¨ Radarr (Films)</h3>
                        <p class="config-hint">Connectez Radarr pour utiliser son format de nommage des films.</p>
                        
                        <div class="config-field">
                            <label>URL Radarr</label>
                            <input type="text" id="config-radarr-url" placeholder="http://localhost:7878">
                        </div>
                        
                        <div class="config-field">
                            <label>Cl√© API Radarr</label>
                            <div class="api-key-input">
                                <input type="password" id="config-radarr-api" placeholder="Cl√© API">
                                <button class="btn btn-secondary btn-sm" onclick="testRadarr()">Tester</button>
                            </div>
                            <span class="connection-status" id="radarr-status"></span>
                        </div>
                    </div>
                    
                    <div class="config-section">
                        <h3>üì∫ Sonarr (S√©ries)</h3>
                        <p class="config-hint">Connectez Sonarr pour utiliser son format de nommage des s√©ries.</p>
                        
                        <div class="config-field">
                            <label>URL Sonarr</label>
                            <input type="text" id="config-sonarr-url" placeholder="http://localhost:8989">
                        </div>
                        
                        <div class="config-field">
                            <label>Cl√© API Sonarr</label>
                            <div class="api-key-input">
                                <input type="password" id="config-sonarr-api" placeholder="Cl√© API">
                                <button class="btn btn-secondary btn-sm" onclick="testSonarr()">Tester</button>
                            </div>
                            <span class="connection-status" id="sonarr-status"></span>
                        </div>
                    </div>
                    
                    <div class="config-section">
                        <h3>üîí Validation</h3>
                        
                        <div class="config-field checkbox-field">
                            <label class="checkbox-label">
                                <input type="checkbox" id="config-require-arr">
                                <span class="checkbox-text">
                                    <strong>Exiger Radarr et Sonarr pour scanner</strong>
                                    <small>Le scan sera bloqu√© si Radarr ou Sonarr n'est pas connect√©</small>
                                </span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="config-section">
                        <h3>üîÑ Scan automatique</h3>
                        
                        <div class="config-field checkbox-field">
                            <label class="checkbox-label">
                                <input type="checkbox" id="config-auto-scan">
                                <span class="checkbox-text">
                                    <strong>Activer le scan automatique</strong>
                                    <small>Scanne p√©riodiquement les nouveaux fichiers</small>
                                </span>
                            </label>
                        </div>
                        
                        <div class="config-field" id="auto-scan-interval-field">
                            <label>Intervalle de scan</label>
                            <div class="interval-input">
                                <input type="number" id="config-auto-scan-interval" min="5" value="30">
                                <select id="config-auto-scan-unit">
                                    <option value="seconds">Secondes</option>
                                    <option value="minutes" selected>Minutes</option>
                                </select>
                            </div>
                            <small class="config-hint">Minimum: 5 secondes / Maximum recommand√©: 60 minutes</small>
                        </div>
                        
                        <div class="auto-scan-status" id="auto-scan-status">
                            <span class="status-indicator"></span>
                            <span class="status-text">Chargement...</span>
                        </div>
                    </div>
                    
                    <div class="config-section">
                        <h3>‚öôÔ∏è Options</h3>
                        
                        <div class="config-field">
                            <label>Langue TMDB</label>
                            <select id="config-tmdb-language">
                                <option value="fr-FR">Fran√ßais</option>
                                <option value="en-US">English</option>
                                <option value="es-ES">Espa√±ol</option>
                                <option value="de-DE">Deutsch</option>
                                <option value="it-IT">Italiano</option>
                            </select>
                        </div>
                        
                        <div class="config-field">
                            <label>Taille minimum des vid√©os (MB)</label>
                            <input type="number" id="config-min-size" min="1" value="50">
                        </div>
                    </div>
                    
                    <div class="config-actions">
                        <button class="btn btn-primary" onclick="saveConfig()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                                <polyline points="17 21 17 13 7 13 7 21"/>
                                <polyline points="7 3 7 8 15 8"/>
                            </svg>
                            Sauvegarder
                        </button>
                    </div>
                    
                    <div class="config-section config-danger">
                        <h3>‚ö†Ô∏è Zone de danger</h3>
                        
                        <div class="danger-action">
                            <div class="danger-info">
                                <strong>R√©initialiser la base de donn√©es</strong>
                                <p>Supprime tous les fichiers de la base de donn√©es et tous les liens (hardlinks/symlinks) cr√©√©s. Les fichiers sources ne sont pas affect√©s.</p>
                            </div>
                            <button class="btn btn-danger" onclick="confirmWipe()">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="3 6 5 6 21 6"/>
                                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                                    <line x1="10" y1="11" x2="10" y2="17"/>
                                    <line x1="14" y1="11" x2="14" y2="17"/>
                                </svg>
                                Tout supprimer
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Tab: Users -->
            <div class="tab-content" id="tab-users">
                <div class="config-container">
                    <h2>üë• Gestion des utilisateurs</h2>
                    
                    <div class="config-section">
                        <h3>Cr√©er un nouvel administrateur</h3>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Nom d'utilisateur</label>
                                <input type="text" id="new-username" class="form-input" placeholder="admin2">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Mot de passe</label>
                                <input type="password" id="new-password" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                            </div>
                        </div>
                        
                        <button class="btn btn-primary" onclick="createUser()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                <circle cx="8.5" cy="7" r="4"/>
                                <line x1="20" y1="8" x2="20" y2="14"/>
                                <line x1="23" y1="11" x2="17" y2="11"/>
                            </svg>
                            Cr√©er l'utilisateur
                        </button>
                    </div>
                    
                    <div class="config-section">
                        <h3>Utilisateurs existants</h3>
                        
                        <div class="users-list" id="users-list">
                            <!-- Liste dynamique des utilisateurs -->
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Modal -->
        <div class="modal-overlay" id="modal-overlay" onclick="closeModal()">
            <div class="modal" onclick="event.stopPropagation()">
                <div class="modal-header">
                    <h2 id="modal-title">Correction manuelle</h2>
                    <button class="btn-icon" onclick="closeModal()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 6 6 18"/>
                            <path d="m6 6 12 12"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body" id="modal-body">
                    <!-- Content loaded via JS -->
                </div>
            </div>
        </div>

        <!-- Browser Modal -->
        <div class="modal-overlay" id="browser-modal" onclick="closeBrowser()">
            <div class="modal browser-modal" onclick="event.stopPropagation()">
                <div class="modal-header">
                    <h2>S√©lectionner un dossier</h2>
                    <button class="btn-icon" onclick="closeBrowser()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 6 6 18"/>
                            <path d="m6 6 12 12"/>
                        </svg>
                    </button>
                </div>
                <div class="browser-toolbar">
                    <div class="browser-path" id="browser-current-path">/mnt</div>
                    <button class="btn btn-secondary btn-sm" onclick="showCreateFolder()">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M5 12h14"/>
                        </svg>
                        Nouveau dossier
                    </button>
                </div>
                <!-- Create folder form (hidden by default) -->
                <div class="create-folder-form" id="create-folder-form" style="display: none;">
                    <input type="text" id="new-folder-name" placeholder="Nom du nouveau dossier" onkeyup="handleFolderNameKeyup(event)">
                    <button class="btn btn-primary btn-sm" onclick="createFolder()">Cr√©er</button>
                    <button class="btn btn-ghost btn-sm" onclick="hideCreateFolder()">Annuler</button>
                </div>
                <div class="modal-body browser-body" id="browser-list">
                    <!-- Directory listing -->
                </div>
                <div class="browser-actions">
                    <button class="btn btn-secondary" onclick="closeBrowser()">Annuler</button>
                    <button class="btn btn-primary" onclick="selectCurrentPath()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="20 6 9 17 4 12"/>
                        </svg>
                        S√©lectionner ce dossier
                    </button>
                </div>
            </div>
        </div>

        <!-- Password Change Modal -->
        <div class="modal-overlay" id="password-modal" onclick="closePasswordModal()">
            <div class="modal modal-small" onclick="event.stopPropagation()">
                <div class="modal-header">
                    <h2>üîí Changer le mot de passe</h2>
                    <button class="btn-icon" onclick="closePasswordModal()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">Nouveau mot de passe</label>
                        <input type="password" id="new-password-change" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Confirmer le mot de passe</label>
                        <input type="password" id="confirm-password-change" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-ghost" onclick="closePasswordModal()">Annuler</button>
                    <button class="btn btn-primary" onclick="changePassword()">Changer le mot de passe</button>
                </div>
            </div>
        </div>
        
        <!-- Toast -->
        <div class="toast-container" id="toast-container"></div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
